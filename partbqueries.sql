create table query1 as select count(*) as "count of comments" from comments where author='xymemez';
create table query2 as select subreddit_type as "subreddit type", count(subreddit_type) as "subreddit count" from subreddits group by subreddit_type;
create table query3 as select subreddit as name, count(subreddit) as "comments count", round(avg(score),2) as " average score" from comments group by subreddit order by count(subreddit) desc limit 10;
create table query4 as select name, link_karma as "link karma", comment_karma as "comment karma", case when link_karma>=comment_karma then '1' else '0' end as label from authors where (link_karma + comment_karma)/2.0>1000000 order by (link_karma + comment_karma)/2.0 desc;
create table query5 as select subreddits.subreddit_type as "sr type", count(comments) as "comments num" from comments inner join subreddits on comments.subreddit=subreddits.display_name where comments.author='[deleted_user]' group by subreddits.subreddit_type;
create table query6 as select to_timestamp(created_utc) at time zone 'utc' as "utc time", subreddit, body as "comment" from comments where author='xymemez' and subreddit='starcraft';
create table query7 as select tempout.submission, tempout.ups, tempout.subreddit as "subreddit" from (select submissions.title as "submission", submissions.ups, temp.display_name as "subreddit", row_number() over (partition by submissions.subreddit_id order by submissions.ups desc) rownum from (select subreddits.name, subreddits.display_name from subreddits where subreddits.over_18='f' order by subreddits.created_utc limit 4) temp inner join submissions on temp.name=submissions.subreddit_id) tempout where rownum<=4 order by tempout.ups desc;
create table query8 as select * from ((select author, ups as upvotes from comments order by ups desc limit 1) union (select author, ups as upvotes from comments order by ups limit 1)) as view  order by upvotes desc; 
create table query9 as select (to_timestamp(created_utc) at time zone 'utc')::date as "date", count(comments) from comments where author='xymemez' group by 1 order by 1;
create table query10 as select extract(month from (to_timestamp(comments.created_utc) at time zone 'utc')::date) as month, subreddits.display_name as "subreddit", count(comments) from comments inner join subreddits on comments.subreddit=subreddits.display_name group by subreddits.display_name, month order by count desc limit 10;